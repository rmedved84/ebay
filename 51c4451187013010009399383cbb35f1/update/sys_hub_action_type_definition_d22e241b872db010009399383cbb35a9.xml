<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_hub_action_type_definition">
    <sys_hub_action_type_definition action="INSERT_OR_UPDATE">
        <access>public</access>
        <acls/>
        <action_template/>
        <active>true</active>
        <annotation/>
        <callable_by_client_api>false</callable_by_client_api>
        <category/>
        <copied_from/>
        <copied_from_name/>
        <description/>
        <ih_action>false</ih_action>
        <internal_name>sync_new_orders</internal_name>
        <label_cache>[]</label_cache>
        <latest_snapshot>1078d19787adb010009399383cbb351f</latest_snapshot>
        <master_snapshot>8b52f4db872db010009399383cbb3580</master_snapshot>
        <name>Sync New Orders</name>
        <natlang/>
        <outputs/>
        <state>published</state>
        <sys_class_name>sys_hub_action_type_definition</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 18:48:02</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>d22e241b872db010009399383cbb35a9</sys_id>
        <sys_mod_count>13</sys_mod_count>
        <sys_name>Sync New Orders</sys_name>
        <sys_overrides/>
        <sys_package display_value="Ebay" source="x_476139_ebay">51c4451187013010009399383cbb35f1</sys_package>
        <sys_policy/>
        <sys_scope display_value="Ebay">51c4451187013010009399383cbb35f1</sys_scope>
        <sys_update_name>sys_hub_action_type_definition_d22e241b872db010009399383cbb35a9</sys_update_name>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 21:52:46</sys_updated_on>
        <system_level>false</system_level>
        <type/>
    </sys_hub_action_type_definition>
    <sys_translated_text action="delete_multiple" query="documentkey=d22e241b872db010009399383cbb35a9"/>
    <sys_variable_value action="delete_multiple" query="document_key=d22e241b872db010009399383cbb35a9"/>
    <sys_hub_step_instance action="delete_multiple" query="action=d22e241b872db010009399383cbb35a9^sys_idNOT INe54e6497872db010009399383cbb353f"/>
    <sys_hub_step_instance action="INSERT_OR_UPDATE">
        <action display_value="Sync New Orders">d22e241b872db010009399383cbb35a9</action>
        <cid>d2f2afb6-6697-4649-abe8-7c4328fda530</cid>
        <extended_inputs/>
        <extended_outputs/>
        <icon/>
        <inputs/>
        <label>Script step</label>
        <order>1</order>
        <outputs/>
        <section/>
        <step_type display_value="Script">106afb6647032200b4fad7527c9a71e7</step_type>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 18:48:31</sys_created_on>
        <sys_id>e54e6497872db010009399383cbb353f</sys_id>
        <sys_mod_count>5</sys_mod_count>
        <sys_scope display_value="Ebay">51c4451187013010009399383cbb35f1</sys_scope>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 21:52:41</sys_updated_on>
    </sys_hub_step_instance>
    <sys_variable_value action="delete_multiple" query="document_key=e54e6497872db010009399383cbb353f"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>e54e6497872db010009399383cbb353f</document_key>
        <order>350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 18:49:09</sys_created_on>
        <sys_id>326e681b872db010009399383cbb35f1</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 18:49:09</sys_updated_on>
        <value/>
        <variable display_value="MID Selection">cbd1070373531010791f94596bf6a776</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>e54e6497872db010009399383cbb353f</document_key>
        <order>400</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 18:49:09</sys_created_on>
        <sys_id>366e681b872db010009399383cbb35f1</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 18:49:09</sys_updated_on>
        <value/>
        <variable display_value="MID Application">f5e56d79b3101300176b051a16a8dce4</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>e54e6497872db010009399383cbb353f</document_key>
        <order>600</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 18:48:31</sys_created_on>
        <sys_id>614ee41b872db010009399383cbb35bd</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 21:52:41</sys_updated_on>
        <value>(function execute(inputs, outputs) {
var today = new GlideDate();
var endDate = today.getDisplayValue() + 'T00:00:00.000Z';
today.addDaysLocalTime(-1);
var startDate = today.getDisplayValue() + 'T00:00:00.000Z';
var params = {
 'filter': 'creationdate:%5B' + startDate + '..' + endDate + '%5D' 
};
var orders = EbayUtil.getOrders(params);
orders = orders.orders;
for(var i = 0; i &lt; orders.length; i++){
	var lineItem = orders[i].lineItems[0];
  var fee = orders[i].totalMarketplaceFee ? orders[i].totalMarketplaceFee.value : 'No fee value was included'
	if(lineItem.sku &amp;&amp; lineItem.sku.toLowerCase().indexOf('inv') == -1){
		var itemGR = new GlideRecord('x_476139_ebay_item');
		itemGR.addQuery('number', lineItem.sku);
		itemGR.query();
		if(itemGR.next()){
			itemGR.setValue('selling_price', lineItem.total.value);
			itemGR.setValue('fees', fee);
			itemGR.setValue('shipping', lineItem.deliveryCost.shippingCost.value);
			itemGR.setValue('name', lineItem.title);
			itemGR.setValue('sale_date', today);
			itemGR.update();
		}
	}else{
		createTask(orders[i]);
	}
}

function createTask(order){
	var lineItem = order.lineItems[0];
  var fee = order.totalMarketplaceFee ? order.totalMarketplaceFee.value : "Fee data was not included";
	var taskGR = new GlideRecord('vtb_task');
	taskGR.initialize();
	var description = 'Sale Price: ' + lineItem.total.value + 
      '\nShipping: ' + lineItem.deliveryCost.shippingCost.value +
      '\nFees: ' + fee
	taskGR.setValue('short_description', lineItem.title);
	taskGR.setValue('owner', '81c8566d878d3010009399383cbb3506');
	taskGR.setValue('active', true);
	taskGR.setValue('description', description);
	var taskID = taskGR.insert();
  
	var cardGR = new GlideRecord('vtb_card');
	cardGR.setValue('lane', '9c5ebe3d87953010009399383cbb354b');
	cardGR.setValue('task', taskID);
	cardGR.setValue('board', 'c45e7e3d87953010009399383cbb3594');
	cardGR.insert();
}
})(inputs, outputs);
</value>
        <variable display_value="Script">71aa7f6647032200b4fad7527c9a719b</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>e54e6497872db010009399383cbb353f</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 18:49:09</sys_created_on>
        <sys_id>ba6e681b872db010009399383cbb35f1</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 18:49:09</sys_updated_on>
        <value/>
        <variable display_value="Select MID Server">2c226939b3101300176b051a16a8dc83</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>e54e6497872db010009399383cbb353f</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 18:49:09</sys_created_on>
        <sys_id>f66e681b872db010009399383cbb35f1</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 18:49:09</sys_updated_on>
        <value/>
        <variable display_value="Required Runtime">74315b04b3201300176b051a16a8dc2b</variable>
    </sys_variable_value>
    <sys_hub_action_plan action="delete_multiple" query="action_id=d22e241b872db010009399383cbb35a9^sys_idNOT IN8752f4db872db010009399383cbb35bf"/>
    <sys_hub_action_plan action="INSERT_OR_UPDATE">
        <action_id display_value="Sync New Orders">d22e241b872db010009399383cbb35a9</action_id>
        <plan>{"persistor":{"@class":".ChunkingPlanPersistor","table":"sys_hub_action_plan","id":"8752f4db872db010009399383cbb35bf","name":"plan"}}</plan>
        <snapshot>1078d19787adb010009399383cbb351f</snapshot>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:23</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>8752f4db872db010009399383cbb35bf</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_overrides/>
        <sys_scope/>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 21:52:46</sys_updated_on>
    </sys_hub_action_plan>
    <sys_hub_action_type_snapshot action="INSERT_OR_UPDATE">
        <access>public</access>
        <acls/>
        <action_template/>
        <annotation/>
        <callable_by_client_api>false</callable_by_client_api>
        <category/>
        <copied_from/>
        <copied_from_name/>
        <description/>
        <internal_name>sync_new_orders</internal_name>
        <label_cache>[]</label_cache>
        <master>true</master>
        <name>Sync New Orders</name>
        <natlang/>
        <outputs/>
        <parent_action display_value="Sync New Orders">d22e241b872db010009399383cbb35a9</parent_action>
        <sys_class_name>sys_hub_action_type_snapshot</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:22</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>8b52f4db872db010009399383cbb3580</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name/>
        <sys_overrides/>
        <sys_package/>
        <sys_policy/>
        <sys_scope display_value="Ebay">51c4451187013010009399383cbb35f1</sys_scope>
        <sys_update_name/>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 19:06:22</sys_updated_on>
        <system_level>false</system_level>
        <type/>
    </sys_hub_action_type_snapshot>
    <sys_translated_text action="delete_multiple" query="documentkey=8b52f4db872db010009399383cbb3580"/>
    <sys_variable_value action="delete_multiple" query="document_key=8b52f4db872db010009399383cbb3580"/>
    <sys_hub_step_instance action="delete_multiple" query="action=8b52f4db872db010009399383cbb3580^sys_idNOT IN8352f4db872db010009399383cbb3584"/>
    <sys_hub_step_instance action="INSERT_OR_UPDATE">
        <action display_value="Sync New Orders">8b52f4db872db010009399383cbb3580</action>
        <cid>d2f2afb6-6697-4649-abe8-7c4328fda530</cid>
        <extended_inputs/>
        <extended_outputs/>
        <icon/>
        <inputs/>
        <label>Script step</label>
        <order>1</order>
        <outputs/>
        <section/>
        <step_type display_value="Script">106afb6647032200b4fad7527c9a71e7</step_type>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:22</sys_created_on>
        <sys_id>8352f4db872db010009399383cbb3584</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_scope display_value="Ebay">51c4451187013010009399383cbb35f1</sys_scope>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 21:52:45</sys_updated_on>
    </sys_hub_step_instance>
    <sys_variable_value action="delete_multiple" query="document_key=8352f4db872db010009399383cbb3584"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>8352f4db872db010009399383cbb3584</document_key>
        <order>400</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:22</sys_created_on>
        <sys_id>0f52f4db872db010009399383cbb358b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 19:06:22</sys_updated_on>
        <value/>
        <variable display_value="MID Application">f5e56d79b3101300176b051a16a8dce4</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>8352f4db872db010009399383cbb3584</document_key>
        <order>600</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:22</sys_created_on>
        <sys_id>4752f4db872db010009399383cbb358c</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 21:52:45</sys_updated_on>
        <value>(function execute(inputs, outputs) {
var today = new GlideDate();
var endDate = today.getDisplayValue() + 'T00:00:00.000Z';
today.addDaysLocalTime(-1);
var startDate = today.getDisplayValue() + 'T00:00:00.000Z';
var params = {
 'filter': 'creationdate:%5B' + startDate + '..' + endDate + '%5D' 
};
var orders = EbayUtil.getOrders(params);
orders = orders.orders;
for(var i = 0; i &lt; orders.length; i++){
	var lineItem = orders[i].lineItems[0];
  var fee = orders[i].totalMarketplaceFee ? orders[i].totalMarketplaceFee.value : 'No fee value was included'
	if(lineItem.sku &amp;&amp; lineItem.sku.toLowerCase().indexOf('inv') == -1){
		var itemGR = new GlideRecord('x_476139_ebay_item');
		itemGR.addQuery('number', lineItem.sku);
		itemGR.query();
		if(itemGR.next()){
			itemGR.setValue('selling_price', lineItem.total.value);
			itemGR.setValue('fees', fee);
			itemGR.setValue('shipping', lineItem.deliveryCost.shippingCost.value);
			itemGR.setValue('name', lineItem.title);
			itemGR.setValue('sale_date', today);
			itemGR.update();
		}
	}else{
		createTask(orders[i]);
	}
}

function createTask(order){
	var lineItem = order.lineItems[0];
  var fee = order.totalMarketplaceFee ? order.totalMarketplaceFee.value : "Fee data was not included";
	var taskGR = new GlideRecord('vtb_task');
	taskGR.initialize();
	var description = 'Sale Price: ' + lineItem.total.value + 
      '\nShipping: ' + lineItem.deliveryCost.shippingCost.value +
      '\nFees: ' + fee
	taskGR.setValue('short_description', lineItem.title);
	taskGR.setValue('owner', '81c8566d878d3010009399383cbb3506');
	taskGR.setValue('active', true);
	taskGR.setValue('description', description);
	var taskID = taskGR.insert();
  
	var cardGR = new GlideRecord('vtb_card');
	cardGR.setValue('lane', '9c5ebe3d87953010009399383cbb354b');
	cardGR.setValue('task', taskID);
	cardGR.setValue('board', 'c45e7e3d87953010009399383cbb3594');
	cardGR.insert();
}
})(inputs, outputs);
</value>
        <variable display_value="Script">71aa7f6647032200b4fad7527c9a719b</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>8352f4db872db010009399383cbb3584</document_key>
        <order>350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:22</sys_created_on>
        <sys_id>4b52f4db872db010009399383cbb358b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 19:06:22</sys_updated_on>
        <value/>
        <variable display_value="MID Selection">cbd1070373531010791f94596bf6a776</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>8352f4db872db010009399383cbb3584</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:22</sys_created_on>
        <sys_id>8352f4db872db010009399383cbb358c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 19:06:22</sys_updated_on>
        <value/>
        <variable display_value="Select MID Server">2c226939b3101300176b051a16a8dc83</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_hub_step_instance</document>
        <document_key>8352f4db872db010009399383cbb3584</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>rmedved</sys_created_by>
        <sys_created_on>2021-07-29 19:06:22</sys_created_on>
        <sys_id>cf52f4db872db010009399383cbb358b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>rmedved</sys_updated_by>
        <sys_updated_on>2021-07-29 19:06:22</sys_updated_on>
        <value/>
        <variable display_value="Required Runtime">74315b04b3201300176b051a16a8dc2b</variable>
    </sys_variable_value>
</record_update>
